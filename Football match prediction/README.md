
<a name="_heading=h.y63pyhchxyxo"></a>Проект
# <a name="_heading=h.qvk0h5pwe773"></a>**Прогнозирование футбольного матча**

|<p></p><p>2017 год. Частный инвестор, неравнодушный к спорту, а в особенности – к футболу, ищет команду аналитиков, способных разгадать код игры ☺</p><p>Вам необходимо создать дашборд, который позволит любителю футбола принимать решения, на какую команду делать ставку по конкретному матчу, и убедить его в эффективности алгоритма.</p><p>**Ваша задача –** создать дашборд, который предсказывает результат игры двух футбольных команд в зависимости от ключевых характеристик матча.</p>|
| :- |

Изначальные данные:

Country.csv, League.csv, 

Match.csv, -проведенные матчи

Player.csv, Player\_Attributes.csv, -игроки и их характеристики

Team.csv, Team\_Attributes.csv - команды и их характеристики

Что использовалось при принятии решения:

1. **Провел интервью со знакомым футбольным фанатом** для погружения в сферу футбольных ставок, собрал необходимую информацию для обработки данных, понял, что означают  предложенные данные.
1. **База данных с информацией**
   1. Определил, с какими данными буду работать.
   1. Привел данные к виду, удобному для дальнейшей обработки в Python в SQL (чистка данных, join файлов с командой и игроками, важны данные за последний сезон).

Результат:

**new\_player.csv; new\_match.csv; new\_team.csv**

1. **Jupyter Notebook**

**Нахождение метрик**

**teams\_strength\_per\_match.ipynb**  
**last\_five\_matches.ipynb**

В результате анализа выбраны ключевые метрики, составленные из имеющихся данных: 

<a name="_heading=h.ub3gp6eyayo1"></a>сила команды, результаты последних пяти матчей, важны результаты только за прошедший сезон. ( выбор таких параметров был осуществлен при наводке знакомого футбольного фаната, анализ исходных показателей показал слабую корреляцию с результатом матча)

Дописал метрики в один общий файл: **match\_final.csv**

1. **Логистическая регрессия**
   1. **prediction\_match.ipynb - составляем вероятность выиграть для команд**

      получаем два файла с прогнозом на исторические данные и для будущих матчей

   1. Triple.ipynb - учет ничьей в результате матча, возникли проблемы с выставлением вероятности. Метод (one-vs-rest). Анализ данных показал, что есть перевес при победе домашней команды.
1. **Дашборд.** 

   1\. На первом дашборде можно сравнить предсказание с букмекерами для исторических матчей [historical ](https://public.tableau.com/app/profile/arman.osipian/viz/CL-DA-Project3-Team2/sheet5) 

   2\. На втором дашборде представлены предсказания по новым матчам [Predicton](https://public.tableau.com/app/profile/arman.osipian/viz/CL-DA-Project3-Predicton-Team2/sheet3) 

   Дашборд показывает ключевые характеристики для двух выбранных команд, у какой команды больше шансов на победу, определяет вероятность победы каждой команды 

1. **Итоговая презентация** для потенциального инвестора



### Материалы для работы
- Задача проекта.
- [European Soccer Database](https://www.kaggle.com/hugomathien/soccer) ― данные о футбольных командах и футболистах Европы. Обратите внимание на ссылки и пояснения, которые дает сам автор базы данных.
- [Перевод файла](https://docs.google.com/document/d/1ota0o-8YH7lTC0Y6rYW576B5vkR00Wm_/edit?usp=sharing&ouid=106514234102082814642&rtpof=true&sd=true) с комментариями автора базы данных, как интерпретировать ставки. Оригинал вы можете найти на kaggle.
- # <a name="_heading=h.4g3p8q5vnm8k"></a>Пояснение к интерпретации ставок (ниже)
  Перевод файла с комментариями автора базы данных, как интерпретировать ставки. Оригинал вы можете найти на kaggle.
- # <a name="_heading=h.yfpxc53vc4pj"></a>Cловарь футбольных терминов (ниже)


Полученный результат сравнивался с букмекерскими ставками
###
# <a name="_heading=h.cv1na2oq66ht"></a><a name="_heading=h.rv71iqzbbsti"></a>Пояснение к интерпретации ставок
Это перевод [файла,](http://www.football-data.co.uk/notes.txt) который вы можете найти [здесь.](https://www.kaggle.com/hugomathien/soccer)

Все данные представлены в формате .csv, готовом для использования в стандартных приложениях для работы с таблицами.

Пожалуйста, обратите внимание, что некоторые сокращения больше не используются (в частности, коэффициенты от конкретных букмекерских контор) и относятся к данным, собранным в предыдущие сезоны. Для получения текущего списка букмекерских контор, включенных в набор данных, посетите[ http://www.football-data.co.uk/matches.php](http://www.football-data.co.uk/matches.php)

### <a name="_heading=h.muc3rvjzcpqv"></a>Ключи к данным о результатах матчей:
Div = Дивизион Лиги

Date = Дата матча (дд/мм/гг)

Time = Время начала матча

HomeTeam = Команда, играющая дома (на чьем стадионе проходит матч)

AwayTeam = Команда, играющая в гостях (играет на стадионе соперника)

FTHG and HG = Full Time Home Team Goals = Голы за все время матча<sup>[^1]</sup> команды дома

FTAG and AG = Full Time Away Team Goals = Голы за все время матча команды в гостях

FTR and Res = Full Time Result (H=Home Win, D=Draw, A=Away Win) = Результат игры в основное время (H=победа команды дома, D=ничья, A=победа команды на выезде)

HTHG = Half Time Home Team Goals = Голы команды дома за первую половину матча

HTAG = Half Time Away Team Goals = Голы команды на выезде за первую половину матча

HTR = Half Time Result (H=Home Win, D=Draw, A=Away Win) = Счет после первой половины матча (H=команда дома лидирует в счете, D=ничья, A=команда на выезде лидирует в счете)

### <a name="_heading=h.gccj1r8kfkw3"></a>Статистика матчей (при наличии)
Attendance = Наполняемость стадиона

Referee = Судья матча

HS = Home Team Shots = Удары хозяев поля

AS = Away Team Shots = Удары гостевой команды

HST = Home Team Shots on Target = Удары хозяев поля в створ ворот

AST = Away Team Shots on Target = Удары гостевой команды в створ ворот

HHW = Home Team Hit Woodwork = Удары хозяев поля в перекладину или штангу

AHW = Away Team Hit Woodwork = Удары команды на выезде в перекладину или штангу

HC = Home Team Corners = Угловые хозяев поля

AC = Away Team Corners = Угловые команды на выезде

HF = Home Team Fouls Committed = Фолы, совершенные хозяевами поля

AF = Away Team Fouls Committed = Фолы, совершенные гостевой командой

HFKC =  Home Team Free Kicks Conceded = Удары, пропущенные домашней командой со штрафного

AFKC = Away Team Free Kicks Conceded = Удары, пропущенные гостевой командой со штрафного

HO = Home Team Offsides = Офсайды команды дома

AO = Away Team Offsides = Офсайды гостевой команды

HY = Home Team Yellow Cards = желтые карточки хозяев поля

AY = Away Team Yellow Cards = желтые карточки гостевой команды

HR = Home Team Red Cards = красные карточки хозяев поля

AR = Away Team Red Cards = красные карточки гостевой команды

HBP = Home Team Bookings Points (10 = yellow, 25 = red) = общее количество очков по карточкам хозяев поля (10 очков за желтую карточку, 25 – за красную)

ABP = Away Team Bookings Points (10 = yellow, 25 = red) = общее количество очков по карточкам гостевой команды

|<p></p><p>Обратите внимание:</p><p>1. Пропущенные штрафные удары (иногда называют свободные удары) (FKC) включают в себя фолы, офсайды и любые другие нарушения, поэтому их число всегда будут равно или превышать количество фолов. Фолы являются основной причиной назначения штрафных ударов. Свободные удары отображаются, когда конкретные данные о фолах недоступны (2-й дивизион Франции, 1-й дивизион Бельгии и 1-й дивизион Греции).</p><p>2. Данные по желтым карточкам английской и шотландских лиг не включают первую желтую карточку, в тех случаях, когда игрок получает вторую желтую, превращающую ее в красную, но она включена как желтая (плюс красная) для матчей Европейских лиг.</p><p></p>|
| :- |

### <a name="_heading=h.8nxm03q6j5rp"></a>**Ключ к данным о коэффициентах ставок 1X2**<sup>[^2]</sup>

В начале расшифровки аббревиатуры идет название букмекерской конторы.

home win odds = коэффициент на победу хозяев

draw odds = коэффициент на ничью

away win odds = коэффициент на победу гостей



B365H = Bet365 home win odds

B365D = Bet365 draw odds

B365A = Bet365 away win odds

BSH = Blue Square home win odds

BSD = Blue Square draw odds

BSA = Blue Square away win odds

BWH = Bet&Win home win odds

BWD = Bet&Win draw odds

BWA = Bet&Win away win odds

GBH = Gamebookers home win odds

GBD = Gamebookers draw odds

GBA = Gamebookers away win odds

IWH = Interwetten home win odds

IWD = Interwetten draw odds

IWA = Interwetten away win odds

LBH = Ladbrokes home win odds

LBD = Ladbrokes draw odds

LBA = Ladbrokes away win odds

PSH and PH = Pinnacle home win odds

PSD and PD = Pinnacle draw odds

PSA and PA = Pinnacle away win odds

SOH = Sporting Odds home win odds

SOD = Sporting Odds draw odds

SOA = Sporting Odds away win odds

SBH = Sportingbet home win odds

SBD = Sportingbet draw odds

SBA = Sportingbet away win odds

SJH = Stan James home win odds

SJD = Stan James draw odds

SJA = Stan James away win odds

SYH = Stanleybet home win odds

SYD = Stanleybet draw odds

SYA = Stanleybet away win odds

VCH = VC Bet home win odds

VCD = VC Bet draw odds

VCA = VC Bet away win odds

WHH = William Hill home win odds

WHD = William Hill draw odds

WHA = William Hill away win odds



Bb = букмекерские конторы BetBrain

Bb1X2 = Количество букмекерских контор BetBrain, используемых для расчета коэффициентов на матч по ставкам 1Х2

BbMxH = Betbrain maximum home win odds = максимальный коэффициент на победу хозяев поля

BbAvH = Betbrain average home win odds = средний коэффициент на победу хозяев поля

BbMxD = Betbrain maximum draw odds = максимальный коэффициент на ничью

BbAvD = Betbrain average draw win odds = средний коэффициент на ничью

BbMxA = Betbrain maximum away win odds = максимальный коэффициент на победу команды на выезде

BbAvA = Betbrain average away win odds = средний коэффициент на победу команды на выезде



Market = коэффициент среди всех букмекерских контор

MaxH = Market maximum home win odds

MaxD = Market maximum draw win odds

MaxA = Market maximum away win odds

AvgH = Market average home win odds

AvgD = Market average draw win odds

AvgA = Market average away win odds
###
### <a name="_heading=h.t0zmihmet956"></a><a name="_heading=h.b41lbmesxq31"></a>Ключ к ставкам с азиатским гандикапом<sup>[^3]</sup>

BbAH = Number of BetBrain bookmakers used to Asian handicap averages and maximums = Количество букмекерских контор BetBrain, используемых для расчета средних и максимальных значений

BbAHh = Betbrain size of handicap (home team) = Величина гандикапа (хозяев поля) у букмекеров Betbrain

AHh = Market size of handicap (home team) (since 2019/2020) = величина гандикапа на победу хозяев матча у всех букмекерских контор

BbMxAHH = Betbrain maximum Asian handicap home team odds = максимальный гандикап на победу хозяев поля (фора + коэффициент)

BbAvAHH = Betbrain average Asian handicap home team odds = средний гандикап на победу хозяев поля

BbMxAHA = Betbrain maximum Asian handicap away team odds = максимальный гандикап на победу команды на выезде

BbAvAHA = Betbrain average Asian handicap away team odds



GBAHH = Gamebookers Asian handicap home team odds

GBAHA = Gamebookers Asian handicap away team odds

GBAH = Gamebookers size of handicap (home team)

LBAHH = Ladbrokes Asian handicap home team odds

LBAHA = Ladbrokes Asian handicap away team odds

LBAH = Ladbrokes size of handicap (home team)

B365AHH = Bet365 Asian handicap home team odds

B365AHA = Bet365 Asian handicap away team odds

B365AH = Bet365 size of handicap (home team)

PAHH = Pinnacle Asian handicap home team odds

PAHA = Pinnacle Asian handicap away team odds

MaxAHH = Market maximum Asian handicap home team odds

MaxAHA = Market maximum Asian handicap away team odds       

AvgAHH = Market average Asian handicap home team odds

AvgAHA = Market average Asian handicap away team odds
###
### <a name="_heading=h.d2vnif83fm7b"></a><a name="_heading=h.rwznjnoqx86a"></a>Коэффициенты на момент закрытия приема ставок (последние коэффициенты перед началом матча)
По аналогии с аббревиатурами выше, но с дополнительным символом "C" после букв аббревиатуры букмекерской конторы/Max/Avg.

Football-Data хотела бы поблагодарить следующие источники, которые были использованы при составлении файлов с данными результатов и коэффициентов Football-Data.

Результаты матчей:

Рекорды XScores - http://www.xscores .ком

` `Статистика матчей:

BBC, ESPN Soccer, Bundesliga.de, Gazzetta.it and Football.fr

Коэффициенты ставок букмекеров:

Индивидуальные букмекерские конторы

\*Коэффициенты ставок на игры выходного дня собираются в пятницу днем, а на игры в середине недели - во вторник днем.

Дополнительная статистика матчей (угловые, броски, предупреждения, судья и т.д.) за сезоны 2000/01 и 2001/02 для английской, шотландской и немецкой лиг была предоставлена Sports.com (у компании сменились собственники, и данные более не доступны

# <a name="_heading=h.bo4a82w0rt9"></a><a name="_heading=h.l28hiveupdtl"></a>Cловарь футбольных терминов

|<p></p><p>Система FIFA **–** рейтинго-балльная, большинство показателей представлены в виде рейтингового числа, где 100 **–** максимум. </p>|
| :- |
###
### <a name="_heading=h.cw0p6ah3dbzk"></a><a name="_heading=h.ocmtyl5qmd5v"></a>Персональные показатели игроков

|**Английский термин**|**Русский термин**|**Пояснение**|
| :- | :- | :- |
|attacking\_work\_rate|уровень атаки|Уровень участия игрока в атакующих действиях своей команды. Может быть высокий, средний и низкий|
|defensive\_work\_rate|уровень защиты|Уровень участия игрока в защитных действиях своей команды. Может быть высокий, средний и низкий|
|crossing|навесы|Передача мяча путем подбрасывания его в воздух в направлении игрока своей команды|
|finishing|точность удара|Cпособность игрока забивать голы после ударов|
|heading\_accuracy|точность игры головой|Способность игрока осуществлять удары в воздухе головой|
|short\_passing|короткий пас/передача|Коротким считает пас на 5-10 метров|
|volleys|удар с лета|Удар по мячу без отскока от земли|
|dribbling|дриблинг/обводка|Длительное индивидуальное ведение мяча как можно ближе к стопе ноги с обводкой игроков соперника при этом с использованием разнообразных технических обманных приёмов|
|curve|подкрутка (крученый удар)|Подкрутить мяч можно внутренней и внешней стороной стопы. От этого траектория удара становится сложнее для соперника|
|free\_kick\_accuracy|точность штрафного|<p>Точность, с которой игрок выполняет штрафные удары. Штрафной удар **–** это специально назначаемый в случае нарушения правил</p><p>удар по воротам </p>|
|long\_passing|длинная передача/пас|Передача мяча на расстояние более 20 метров|
|ball\_control|владение мячом|Уровень владения мяча игроком|
|acceleration|скорость разгона|Как быстро игрок набирает максимальную скорость|
|sprint\_speed|скорость рывков|Скорость, с которой игрок преодолевает короткие отрезки|
|agility|ловкость|Скорость ускорения и смены направлений игрока|
|reactions|реакция|Скорость реакции на игровые события|
|balance|баланс|Умение игрока сохранять равновесие|
|shot\_power|сила удара|Сила удара игрока|
|jumping|прыжки|Умение игрока далеко и высоко прыгать|
|stamina|выносливость|Как быстро кончаются силы|
|strength|сила|Физическая способность оттеснять защитников корпусом|
|long\_shots|дальние удары|Способность игрока выполнить удар по воротам из-за штрафной зоны (более 20 метров)|
|aggression|агрессия|Уровень агрессии игрока. Игрок с высоким показателем в этой характеристике всегда готов к жестким действиям по отношению к сопернику|
|interceptions|перехваты|Умение игрока перехватить мяч у соперника|
|positioning|выбор позиции|Умение игрока занять правильную позицию на поле|
|vision|видение игры|Способность игрока находить на поле игроков своей команды для выполнения передач|
|penalties|пенальти|Умение игрока выполнять штрафные удары по воротам соперника|
|marking|собранность|Способность игрока быстро проанализировать игру и принять эффективное решения перед выполнением удара|
|standing\_tackle|подкат|Отбор мяча у соперника в подкате без падения|
|sliding\_tackle|скользящий подкат|Отбор мяча у соперника, который осуществляется одной вытянутой ногой в падении, чтобы оттолкнуть мяч от игрока противника.|
|gk\_diving|нырок вратаря|Прыжок вратаря к низколетящему мячу, для которого нужно прыгнуть скорее вперед, а не наверх|
|gk\_handling|игра руками|То, как  точно вратарь может выбросить мяч в поле руками|
|gk\_kicking|игра ногами|То, как точно вратарь может выбить мяч в поле ногами|
|gk\_positioning|позиция вратаря|Умение вратаря выбрать правильную позицию при ударе|
|gk\_reflexes|рефлексы|Скорость реакции вратаря|

### <a name="_heading=h.iuwc962aoip1"></a>Командные показатели
Build up - тактика команды в атаке/нападении.

Chance creation - тактика команды при создании голевых моментов.

Defence - тактика команды в обороне/защите.

|buildUpPlaySpeed|скорость атаки команды|Скорость в баллах, с которой команда совершает атаку|
| :- | :- | :- |
|buildUpPlaySpeedClass|уровень скорости атаки команды|Высокий, средний (сбалансированный), низкий|
|buildUpPlayDribbling|уровень дриблинга команды в нападении|Измеряется в баллах|
|buildUpPlayDribblingClass|уровень дриблинга команды в нападении|Достаточно (normal), мало (little)|
|buildUpPlayPassing|уровень передач в атаке|Измеряется в баллах|
|buildUpPlayPassingClass|тип передач в атаке|Короткие, длинные, смешанные|
|buildUpPlayPositioningClass|расположение команды в нападении|Свободное (free form), организованное (organised)|
|chanceCreationPassing|рискованность передач при создании голевых моментов|Измеряется в баллах|
|chanceCreationPassingClass|уровень рискованности передач при создании голевых моментов|Высокий риск, обычный, осторожный|
|chanceCreationCrossing|количество навесов в штрафной зоне при создании голевых моментов|Измеряется в баллах|
|chanceCreationCrossingClass|количество навесов в штрафной зоне при создании голевых моментов|Много, мало, среднее|
|chanceCreationShooting|количество ударов по воротам при создании голевых моментов|Измеряется в баллах|
|chanceCreationShootingClass|количество ударов по воротам при создании голевых моментов|Много, мало, среднее|
|chanceCreationPositioningClass|расположение команды при создании голевых моментов|Свободное (free form), организованное (organised)|
|defencePressure|прессинг в обороне|Активное нападение на игроков другой команды, владеющих мячом|
|defencePressureClass|уровень прессинга в обороне|Низкий (deep), средний (medium), высокий (high)|
|defenceAggression|агрессивность в обороне|Способность игроков в защите отбирать и перехватывать мяч у соперника|
|defenceAggressionClass|уровень агрессии в обороне|Сдержанный (contain), умеренный (press), сильный (double)|
|defenceTeamWidth|ширина расположения команды в защите|Насколько удаленно игроки расположены к своим воротам в защите|
|defenceTeamWidthClass|степень ширины расположения команды в защите|Широко расположены от ворот (wide), средне (normal), близко (narrow)|
|defenceDefenderLineClass|оборонительная линия|Оборонительная линия **–** цепочка игроков защиты|
|2 варианта оборонительной линии:|||
|Offside trap|<p>Офсайд в футболе – положение, при котором атакующий игрок в момент передачи от партнера находится ближе к воротам соперника, чем мяч или предпоследний игрок соперника. Если говорить простыми словами, то игрок находится в положении «вне игры», если в момент передачи он находится к воротам ближе, чем защитник.</p><p>офсайдная<sup>[^4]</sup> ловушка</p>|Футбольный прием, который позволяет обороняющейся команде разрушить атаку соперника и завладеть мячом, при этом не вступая в отбор|
|Cover|индивидуальная опека|Игроки в защите индивидуально находятся так близко к атакующему противнику, что в состоянии помешать ему во время приема мяча|


### <a name="_heading=h.bvd3v0esm1k"></a><a name="_heading=h.llf14m236ldr"></a>Прочее

|Shots on Target|удар в створ ворот|Мяч летел в ворота, но игрок его отбил|
| :- | :- | :- |
|Corner|угловой|Возврат мяча в игру из угла поля. Угловой назначается, если мяч ушел за линию игрового поля.|
|Foul|фол|Действие игрока, противоречащее правилам и приводящее к остановке игры судьей. Например, игрок может толкнуть соперника, сделать подножку или задержать его.|
|Yellow card|желтая карточка|Желтой карточкой судья предупреждает игрока о нарушении правил игры|
|Red card|красная карточка|Красной карточкой судья удаляет игрока с поля после двух желтых карточек или за одно грубое нарушение правил|


|<p></p><p></p>||
| :- | -: |


[^1]: Два тайма по 45 минут каждый + дополнительное время.
[^2]: Ставка на основной исход (победа одной или другой команды, или ничья).
[^3]: В азиатском гандикапе есть всего два варианта исхода (победа одной из команд), а числа могут быть дробными.
[^4]: 
